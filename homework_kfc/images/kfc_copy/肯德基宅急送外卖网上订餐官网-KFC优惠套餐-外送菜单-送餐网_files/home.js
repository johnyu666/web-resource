function computationPrice(A){return(A/100).toFixed(1)}function wlClick(B,A){if(B==2){if(A.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(A,"","")}}else{if(B==1){KFC_Comon.initContent(A)}}}var popBannerClose=true;var KFC_Comon=function(){var H=function(X){var W=[];var V={};for(var T=0;T<X.length;T++){var U=X[T];var S=typeof(U)+U;if(V[S]!==1){W.push(U);V[S]=1}}return W};var M=function(U,V){var T=KFC_Promotions.getPromotionVosById(U);if(!T){return false}if(T.multiuse){return true}var W=KFC_Promotions.getPromNumInCart(T)+1;var S=KFC_Promotions.vaildPromQuantity(T,W,U,true);return S};var R=function(T,X){var V=$(".home_bg_mid");var U=$("#topFlag");var S=$("#rolling");var W=$("#popBannerTemp");$.ajax({url:requestContextPath+"/getMenuJson.action",type:"post",async:false,data:{classId:$.trim(T),topFlag:U.val()},dataType:"json",beforeSend:function(){base.yumOpenLoading()},success:function(a){if(a){if(2==a.code){return}if(a.status&&a.status.code==10014){base.yumAlertBack(property.userNotFound,function(){base.setActionHttps("orderLogin.action")});return}var Z=false;if($.cookie(yumCfg.beforeLoginWow)=="1"){Z=true;$.cookie(yumCfg.beforeLoginWow,null,{path:"/kfcios"})}if((a.status&&a.status.code==50000)||Z){if(validIE6().indexOf("MSIE 6.0")>0){base.yumAlert(property.wowBarrelNoIE6);return}var Y=KFC_Cart.validWowBarrelItem();if(Y==null){if(window._tag){_tag.dcsMultiTrack("wt.event","WOW","wt.msg",X)}setTimeout(function(){base.setAction("wowBarrel.action")},50);return}else{base.yumConfirm(property.wowBarrelCartError,function(){var d=Y;var e={opFlag:0,objectId:d.index,orderItemId:d.id,productId:d.productId,quantity:0};var c="executeOrder.action";$.ajax({url:requestContextPath+"/"+c,type:"post",dataType:"json",data:e,success:function(f){if(!f){return}if(B(f.status)){return}if(!f.order){return}if(!f.order.items){return}base.setAction("wowBarrel.action");return}})});return}}if(a.nMenuVo&&0==a.nMenuVo.length){if("Y"==$("#gotoBeforeLoginClass").val()&&"Y"==$("#addBeforeLoginProduce").val()){KFC_Comon.initContent(KFC_Comon.getDefClassId())}}KFC_GlobalVar.add(a);if(U.val()=="w1"){N(V,a)}else{if("Y"==a.carnivalMenu){L(V,a)}else{if("Y"==a.isSinglePage){P(V,a)}else{O(V,a)}}}if(a.bannerPopup){Q(W,a.bannerPopup)}if(!a.hotlinkList){S.empty();if(a.wordlinkList){var b=a.httpWordLinkPath;I(a.wordlinkList,S,b)}}}U.val("");KFC_Comon.initPopBanner()},error:function(){base.yumAlert(property.netError)},complete:function(){base.yumCloseLoading()}})};var C=function(){$("#rolling p").each(function(T,S){$(S).live("click",function(){var U=$(S).attr("rtype");var W=$(S).attr("linkurl");var X=$(S).attr("linkcid");var V="";if(U==2){V=W}else{if(U==1){V=X}}if(window._tag){_tag.dcsMultiTrack("wt.event","首页超链接","wt.msg",$(S).text())}wlClick(U,V)})})};var J=function(){$("#hotlink a").each(function(T,S){$(S).live("click",function(){var U=$(S).attr("rtype");var W=$(S).attr("linkUrl");var X=$(S).attr("linkCid");var V="";if(U==2){V=W}else{if(U==1){V=X}}if(window._tag){_tag.dcsMultiTrack("wt.event","首页超链接","wt.msg",$(S).text())}wlClick(U,V)})})};var I=function(U,S,T){cleanSilder();$.each(U,function(W,V){S.append(KFC_HTML.getWordLink({rType:V.relationType,cId:V.linkedClassId,linkCid:V.linkedClassId,linkUrl:T+V.linkedUrl,titleCn:V.descCn,titleEn:V.descEn,textCn:V.textCn,textEn:V.textEn,textType:V.textType}))});initSilder()};var Q=function(T,U){T.empty();var S=null;KFC_Banner.empty();$.each(U,function(X,W){var V={id:W.id,imageUrl:W.imageUrl,linkedUrl:W.linkedUrl,classId:W.classId,linkType:W.linkType,smallPictureUrl:W.smallPictureUrl,isPopup:W.isPopup,title:$.localStr({cn:W.titleCn,en:W.titleEn},1)};S=KFC_HTML.getBannerPopTemp(V);KFC_Banner.add(W.id,S,W.isPopup,W.type);return false});T.append(S)};var N=function(T,W){cleanBanner();T.empty();KFC_GlobalVar.add(W);var a=$('<p class="mt7px index_banner"/>');var b=$('<div class="kvContent" id="kvContent">');var V=$('<p class="mt7px sbanner"/>');var Y=0;var U=0;var X=0;var Z=0;$.each(W.bannerVoList,function(e,d){if(d.type==1){Z=Z+1}if(d.type==1&&Z>6){}else{var c=KFC_HTML.getBannerTemp({id:d.id,imageUrl:d.imageUrl,type:d.type,position:d.position,linkedUrl:d.linkedUrl,classId:d.classId,linkType:d.linkType,title:$.localStr({cn:d.titleCn,en:d.titleEn},1),bflag:Y,rflag:U,lflag:X,bigOrder:Z});if(d.type==1){Y++}else{if(d.position==1){X++}else{U++}}if(d.type==1){a.append(b.append(c))}else{V.append(c)}}});var S=KFC_HTML.getBannerCorner(Z);a.append(b.append(S));T.append(a,V);kvNav();scroll_kfc()};var L=function(S,V){S.empty();KFC_Products.empty();KFC_Original.empty();KFC_HPT.empty();var U='<div class="prod_show" style="width:600px"/>',c='<ul class="product_ul_carnival"/>';var g=$(U);var W=$(c);S.append(g.append(W));var a=V.specialClass;var b=V.specialClassForOne;var j=V.specialClassForTwo;var f=V.specialClassForThree;var X=V.specialClassForFour;var d={};for(var T in f.menuVoList){if(f.menuVoList[T].menuType=="0"){d[f.menuVoList[T].lunch]=f.menuVoList[T].lunch}}for(var i in j.menuVoList){if(j.menuVoList[i].menuType=="0"){d[j.menuVoList[i].lunch]=j.menuVoList[i].lunch}}$.each(a.menuVoList,function(h,l){var m=KFC_Carnival["specialClassTemp"](l);W.append(m)});var Y=KFC_Carnival["specialClassForOneTemp"](b,d);W.append(Y);var e=KFC_Carnival["specialClassForTowOrThreeTemp"](j,f,d);W.append(e);var Z=KFC_Carnival["specialClassForFourTemp"](X,d);W.append(Z);KFC_Original.add();KFC_Original.closeBtnAll();KFC_OrderBtn.setHptOrOigOrderBtnState();$.each(V.menuPromVo,function(l,h){KFC_Promotions.add(h)})};var O=function(S,W){S.empty();KFC_Products.empty();KFC_Original.empty();KFC_HPT.empty();var a='<div class="prod_show" style="width:600px"/>',Y='<ul class="product_ul"/>';var U=$(a);var Z=$(Y);S.append(U.append(Z));var V=0;var X=W.httpVirtualPath;var T={};for(k in W.nMenuVo){if(W.nMenuVo[k].menuType=="0"){T[W.nMenuVo[k].lunch]=W.nMenuVo[k].lunch}}$.each(W.nMenuVo,function(c,b){if(b.cornerMark){KFC_Ncornermarks.add(b.cornerMark,b.systemId)}if(T[b.systemId]&&b.disabledFlag=="0"&&b.willSaleFlag=="0"){b.lightFlag="1"}var d=KFC_HTML.getProductTemp({id:b.systemId,menuType:b.menuType,name:$.localStr({cn:b.nameCn,en:b.nameEn},1),price:b.price,imageUrl:b.imageUrl,menuFlag:b.menuFlag,virtualLink:X+b.virtualLinkUrl,virtualLinkClass:b.virtualLinkClass,virtualLinkType:b.virtualLinkType,lightFlag:b.lightFlag,descCn:b.descCn,descEn:b.descEn,couponDescCn:b.couponDescCn,couponDescEn:b.couponDescEn,lunch:b.lunch,disabledFlag:b.disabledFlag,willSaleFlag:b.willSaleFlag,linkShowType:b.linkShowType,index:c});Z.append(d);KFC_Products.add(b,V,d);KFC_HPT.addHalfPirce(b.menuType,b.systemId,d,b.lunch);V++});KFC_Original.add();KFC_Original.closeBtnAll();KFC_OrderBtn.setHptOrOigOrderBtnState();$.each(W.menuPromVo,function(c,b){KFC_Promotions.add(b)})};var P=function(V,T){V.empty();KFC_Products.empty();KFC_Original.empty();KFC_HPT.empty();var U=T.httpVirtualPath;var S=0;var W={};for(k in T.nMenuVo){if(T.nMenuVo[k].menuType=="0"){W[T.nMenuVo[k].lunch]=T.nMenuVo[k].lunch}}$.each(T.nMenuVo,function(Y,Z){if(W[Z.systemId]&&Z.disabledFlag=="0"&&Z.willSaleFlag=="0"){Z.lightFlag="1"}if(Z.cornerMark){KFC_Ncornermarks.add(Z.cornerMark,Z.systemId)}if("V"!=Z.menuFlag){var X=KFC_HTML.getSingleProductTemp(Z);V.append(X)}KFC_Products.add(Z,S,X);KFC_HPT.addHalfPirce(Z.menuType,Z.systemId,X,Z.lunch);S++});KFC_Original.add();KFC_Original.closeBtnAll();KFC_OrderBtn.setHptOrOigOrderBtnState();$.each(T.menuPromVo,function(Y,X){KFC_Promotions.add(X)})};var A=function(S,W){var T=$("#cart_menus");var V=$(".shop_cart_num");var U=KFC_GlobalVar.getGlobalVarByParam("halfPriceNumber");base.yumOpenLoading();$.ajax({url:requestContextPath+"/"+S,type:"post",dataType:"json",data:W,beforeSend:function(){base.yumOpenLoading()},success:function(Z){if(!Z){return}if(B(Z.status)){return}if(!Z.order){return}if(!Z.order.items){return}T.empty();KFC_Cart.cartItmesEmpty();KFC_GlobalVar.add(Z);var c=0;var d="";var X="";var a="";$.each(Z.order.items,function(h,f){var g="";if(Z.halfPirceId){if(Z.halfPirceId.length>=U){g="0";a=g}X=Z.halfPirceId}if(f.promotionType!=4&&f.promotionType!=5&&f.promotionType!=6){var e=f.price;if(f.itemType==4){e=f.realPrice}T.append(KFC_HTML.getCartTemp({num:f.quantity,isPromo:f.promotionType,id:f.productId,name:$.localStr({cn:f.nameCN,en:f.nameEN},1),price:f.quantity*e,path:Z.base,isAutoPromo:f.autoPromotion,realPrice:f.quantity*f.realPrice,itype:g,itemType:f.itemType,index:c}));KFC_Cart.setCartItmes(f,c,X)}else{if(f.promotionType==5){d="("+$.localStr({cn:f.promotionDescCN,en:f.promotionDescEN},1)+")"}}c++});KFC_HTML.getCartPromotion(Z);if(a){KFC_HPT.closeBtnAll();KFC_Original.openBtnAll()}else{KFC_HPT.openBtnAll();KFC_Original.closeBtnAll()}KFC_HTML.getCartPriceTemp({subtotal:Z.order.subtotal,deliverFee:Z.order.deliverFee,total:Z.order.total,totalProvince:Z.order.totalProvince,channelName:Z.order.channelName,cartRemark:d});V.text(KFC_Cart.getAllItemNum());var b=KFC_Cart.data("operFlag");if(b){if(b=="add"){var Y=KFC_Cart.data("productId");if(Y){KFC_Cart.showPopupWithCart(Y,b)}}else{if(b=="sub"){if(Z.order.popupFlag){var Y=KFC_Cart.data("productId");if(Y){KFC_Cart.showPopupWithCart(Y,b)}}}}}KFC_OrderBtn.setHptOrOigOrderBtnState();return Z.order.warningCode},error:function(){base.yumAlert(property.netError)},complete:function(){base.yumCloseLoading()}})};var D=function(S){KFC_Products.clearProNumOneById(S);$("#"+S).val(1);if(KFC_Promotions.getPromItemsById(S)){KFC_Promotions.getAllPromotionZore(S)}};var K=function(){var T=$("#nav .IClass");var U=$("#topFlag");if(U.val()=="drinks"){var V=$("#beverageClass").val();if(V){return V}}var S=(function(){var W="";T.each(function(){var X=$(this).find("li")[0];if(X){W=$(X).find("a").attr("pid");return false}});return W})();return S};var B=function(X){KFC_Status.empty();var U=0;var V=true;if(X&&X.code){if(X.code==serviceCode.SUC_CODE){return U}else{U=1}if(X.code==serviceCode.USER_NOT_LOGIN){base.yumAlertBack(property.userNotFound,function(){base.loginExit(function(){base.setActionHttps("orderLogin.action")})})}else{if(X.code==serviceCode.ERRORCODE_306){V=false;base.yumAlert(property.ErrorCode_306)}else{if(X.code==10015){var T=KFC_GlobalVar.getGlobalVarByParam("halfPriceNumber");var W=property.halfPriceErrorMsg.format([T]);var S=X.message;KFC_Cart.getCartItmesById(S).quantity=KFC_Cart.getCartItmesById(S).quantity-1;error.yumAlertError(W,true)}else{error.yumAlertError(X.code)}}}if(V){KFC_Status.add(X)}}return U};var F=function(){$.cookie(yumCfg.orderFlag,true,{path:"/"});$.cookie(yumCfg.payFlag,true,{path:"/"})};var E=function(){var U=KFC_Banner.getBannerPopObj();if(undefined==U.popBannerObj){return}else{xunFlag=true}var W=U.popBannerObj;var b=U.isPopup;var S=W.find(".bannerPopup");var Z=W.find(".bannerPopupBg");var a=W.find(".bannerPopupSmall");var T=$.cookie("isBannerPopupLogin");var Y=$(document).width();var X=U.bannerType;if(!$.browser.msie){S.show({complete:function(){S.css("left",(Y-S.width())/2)}})}else{var V=S.show().width();if(V==0){imgReady(imageUrl,function(){V=this.width})}S.css("left",(Y-V)/2)}if($.browser.msie&&$.browser.version==6){Z.height($(document).height()).width($(document).width());$(window).scroll(function(){a.css({"bottom":"","top":$(window).height()+$(window).scrollTop()-5-a.height()})})}if((T==null&&b=="1"&&X==4)){Z.show();S.show();$.cookie("isBannerPopupLogin","false");setTimeout(function(){Z.hide();S.hide();a.show()},6000)}else{Z.hide();S.hide();if(popBannerClose){a.show()}}};var G=function(){var S=$("#userFlag").val()==0?true:false;$(".order_add a").on("click",function(){if(!S){window.location.href=requestContextPath+"/customer.action"}else{$("#changeAddress").show();$("#addAddress_pop").show();$("#addAddress").show();$("#adderssArea_pop").hide();$("#adderssArea").find(".info_table_1 tr").hide();$("#cityName").val($("#cityNameDes").val());$("[cityname="+$("#cityNameDes").val()+"]").click();$("#address2").val($("#mainAddressDes").val());$(".new_add_img").children().click();$(".selectItem").data("autoClick",true);$("#address3").val($("#supplementaladdressDes").val())}});$(".closeAddress").on("click",function(){$(".city_list").hide();$(".selectItem").hide();$("#changeAddress").hide()})};return{initContent:R,initCart:A,initCookie:F,initPropAndPromToNum:D,initPopBanner:E,initHotLink:J,initWordLink:C,vaildPromNum:M,getDefClassId:K,unique:H,vaildStatus:B,bindChangeAddressEvent:G}}();var KFC_OrderBtn={setHptOrOigOrderBtnState:function(){var B=KFC_GlobalVar.getGlobalVarByParam("halfPriceNumber");if(KFC_Cart.getAllCartItems()&&KFC_Cart.getHptNum()>=B){KFC_HPT.closeBtnAll();KFC_Original.openBtnAll()}else{var C=KFC_Cart.getAllCartItems().hptId;if(!C||C.length<=0){return}var E=KFC_Comon.unique(C);var D=KFC_GlobalVar.getGlobalVarByParam("eachHalfPriceNum");for(var A=0;A<E.length;A++){var G=E[A];var F=KFC_Cart.getProdNumById(G);if(D>0){if(F>=D){KFC_HPT.closeBtnByHptPid(G);KFC_Original.openBtnByHalfProdrById(G)}else{KFC_HPT.openBtnByHptPid(G);KFC_Original.closeBtnByHalfProdrById(G)}}}}}};var KFC_Menu={init:function(){this.initElement()},initElement:function(){this.nav=$("#nav").find(".IClass>li");this.initEvent()},initEvent:function(){this.nav.click(this.navAction)},navAction:function(){var A=$(this).find("a").attr("pid");var C=$.trim($(this).find("a").html());var B=$(this).find("a").parent().parent().attr("classtype");if(window._tag){if(B=="L"){_tag.dcsMultiTrack("wt.event",A+"_CT_menu_正餐"+C,"wt.msg","登录,正餐"+C)}else{if(B=="B"){_tag.dcsMultiTrack("wt.event",A+"_CT_menu_早餐"+C,"wt.msg","登录,早餐"+C)}else{if(B=="D"){_tag.dcsMultiTrack("wt.event",A+"_CT_menu_晚餐"+C,"wt.msg","登录,晚餐"+C)}}}}if(!A){return}KFC_Comon.initContent(A,"wowBarrel_menu")}};var KFC_Banner=function(){var A={};var C=function(){var H="";var G="";var F=""};var D=function(J,I,H,G){var F=new C();F.popBannerObj=I;F.isPopup=H;F.bannerType=G;A=F};var E=function(){A={}};var B=function(){return A};return{add:D,empty:E,getBannerPopObj:B}}();var KFC_GlobalVar=function(){var D=function(){this.base="";this.httpVersionPath="";this.httpCornerMarkPath="";this.login="";this.halfPriceNumber=0;this.eachHalfPriceNum=-1};var E={};var B=function(){var H=arguments[0];var G=new D();for(var F in H){if(G.hasOwnProperty(F)){E[F]=H[F]}}};var C=function(F){return E[F]};var A=function(){return E};return{add:B,getGlobalVar:A,getGlobalVarByParam:C}}();var KFC_Status=function(){var B={};var C=function(E){B=E};var D=function(){B={}};var A=function(){return B};return{add:C,empty:D,getStatus:A}}();var KFC_Original=function(){var J={};var D=function(){var M=KFC_HPT.getHptObjAll();for(var N in M){var L=M[N].lunch;if(KFC_Products.getProductById(L)){J[L]=KFC_Products.getProductById(L).$li}}};var H=function(){return J={}};var E=function(){return J};var F=function(L){return J[L]};var C=function(L){if(!KFC_HPT.getHptObjById(L)){return}var N=KFC_HPT.getHptObjById(L).lunch;var O=KFC_Products.getProductById(L);var M=KFC_Products.getProductById(N);var P=F(N);G({herfObj:O,prodObj:M,oriProdId:N,oriProdObj:P})};var I=function(){var L=E();for(var Q in L){var O=KFC_Products.getHalfProdByOriPId(Q);var P=KFC_Products.getProductById(Q);if(O.isOrderFlag=="0"&&P.lightFlag=="1"){if(L[Q].find(":button").size()>0){L[Q].find(":button").removeClass("order_btn_h");if("1"==P.disabledFlag){$button=L[Q].find(":button").addClass("order_btn_h");return}else{if("1"==P.willSaleFlag){$button=L[Q].find(":button").addClass("timeArrived_btn");return}}}else{var N=KFC_GlobalVar.getGlobalVarByParam("base");var M=N+"/res/images/order_btn.gif";if($.isEnglish()){M=N+"/res/images/en/order_btn.gif"}L[Q].find(".center>img").attr("src",M);if("1"==P.disabledFlag){M=N+"/res/images/order_btn_1.png";if($.isEnglish()){M=N+"/res/images/en/order_btn_1.gif"}L[Q].find(".center>img").attr("src",M);return}else{if("1"==P.willSaleFlag){M=N+"/res/images/timeArrived_btn.png";if($.isEnglish()){M=N+"/res/images/en/timeArrived_btn.png"}L[Q].find(".center>img").attr("src",M);return}}}KFC_Products.modifyIsOrderById(Q,1)}}};var G=function(N){var P=N.herfObj;var Q=N.prodObj;var M=N.oriProdObj;var O=N.oriProdId;if(!Q){return}if(P.isOrderFlag=="0"&&Q.lightFlag=="1"){if(M.find(":button").size()>0){M.find(":button").removeClass("order_btn_h");if("1"==Q.disabledFlag){$button=M.find(":button").addClass("order_btn_h");return}else{if("1"==Q.willSaleFlag){$button=M.find(":button").addClass("timeArrived_btn");return}}}else{var L=KFC_GlobalVar.getGlobalVarByParam("base");var R=L+"/res/images/order_btn.gif";if($.isEnglish()){R=L+"/res/images/en/order_btn.gif"}M.find(".center>img").attr("src",R);if("1"==Q.disabledFlag){R=L+"/res/images/order_btn_1.png";if($.isEnglish()){R=L+"/res/images/en/order_btn_1.gif"}M.find(".center>img").attr("src",R);return}else{if("1"==Q.willSaleFlag){R=L+"/res/images/timeArrived_btn.png";if($.isEnglish()){R=L+"/res/images/en/timeArrived_btn.png"}M.find(".center>img").attr("src",R);return}}}KFC_Products.modifyIsOrderById(O,1)}};var B=function(){var L=E();for(var P in L){var N=KFC_Products.getProductById(P);if("1"===N.willSaleFlag){continue}if(L[P].find(":button").size()>0){L[P].find(":button").addClass("order_btn_h")}else{var O=KFC_GlobalVar.getGlobalVarByParam("base");var M=O+"/res/images/order_btn_1.png";if($.isEnglish()){M=O+"/res/images/en/order_btn_1.gif"}L[P].find(".center>img").attr("src",M)}KFC_Products.modifyIsOrderById(P,0)}};var A=function(L){if(!KFC_HPT.getHptObjById(L)){return}var N=KFC_HPT.getHptObjById(L).lunch;var M=KFC_Products.getProductById(N);var O=F(N);K({oriPid:N,pObj:M,oriProd:O})};var K=function(N){var O=N.pObj;var M=N.oriProd;var P=N.oriPid;if(!O||"1"===O.willSaleFlag){return}if(M.find(":button").size()>0){M.find(":button").addClass("order_btn_h")}else{var L=KFC_GlobalVar.getGlobalVarByParam("base");var Q=L+"/res/images/order_btn_1.png";if($.isEnglish()){Q=L+"/res/images/en/order_btn_1.gif"}M.find(".center>img").attr("src",Q)}KFC_Products.modifyIsOrderById(P,0)};return{add:D,empty:H,openBtnAll:I,openOrderBtn:G,openBtnByHalfProdrById:C,closeBtnAll:B,closeOrderBtn:K,closeBtnByHalfProdrById:A,getOriProdAll:E,getOriProdById:F}}();var KFC_HPT=function(){var I={};var L=function(){this.li="";this.lunch=""};var E=function(Q,N,P,M){if(Q=="0"&&KFC_Products.getProductById(N).lightFlag=="1"){var O=new L();O.li=P;O.lunch=M;I[N]=O}};var G=function(){return I={}};var J=function(){return I};var B=function(M){return I[M]};var H=function(){var Q=J();for(var M in Q){var O=KFC_Products.getProductById(M);if("1"===O.willSaleFlag){continue}if(O.lightFlag=="1"){if(Q[M].li.find(":button").size()>0){Q[M].li.find(":button").removeClass("order_btn_h")}else{var P=KFC_GlobalVar.getGlobalVarByParam("base");var N=P+"/res/images/order_btn.gif";if($.isEnglish()){N=P+"/res/images/en/order_btn.gif"}Q[M].li.find(".center>img").attr("src",N)}KFC_Products.modifyIsOrderById(M,1)}}};var C=function(M){var O=KFC_Products.getProductById(M);var N=B(M);F(M,O,N)};var F=function(N,Q,P){if(!Q||"1"===Q.willSaleFlag){return}if(Q.lightFlag=="1"){if(P.li.find(":button").size()>0){P.li.find(":button").removeClass("order_btn_h")}else{var M=KFC_GlobalVar.getGlobalVarByParam("base");var O=M+"/res/images/order_btn.gif";if($.isEnglish()){O=M+"/res/images/en/order_btn.gif"}P.li.find(".center>img").attr("src",O)}KFC_Products.modifyIsOrderById(N,1)}};var D=function(){var Q=J();for(var M in Q){var O=KFC_Products.getProductById(M);if("1"===O.willSaleFlag){continue}if(Q[M].li.find(":button").size()>0){Q[M].li.find(":button").addClass("order_btn_h")}else{var P=KFC_GlobalVar.getGlobalVarByParam("base");var N=P+"/res/images/order_btn_1.png";if($.isEnglish()){N=P+"/res/images/en/order_btn_1.gif"}Q[M].li.find(".center>img").attr("src",N)}KFC_Products.modifyIsOrderById(M,0)}};var A=function(M){var O=KFC_Products.getProductById(M);var N=B(M);K(M,O,N)};var K=function(P,Q,O){if(!Q||"1"===Q.willSaleFlag){return}if(O.li.find(":button").size()>0){O.li.find(":button").addClass("order_btn_h")}else{var M=KFC_GlobalVar.getGlobalVarByParam("base");var N=M+"/res/images/order_btn_1.png";if($.isEnglish()){N=M+"/res/images/en/order_btn_1.gif"}O.li.find(".center>img").attr("src",N)}KFC_Products.modifyIsOrderById(P,0)};return{addHalfPirce:E,empty:G,openBtnAll:H,openBtnOrder:F,openBtnByHptPid:C,closeBtnAll:D,closeOrderBtn:K,closeBtnByHptPid:A,getHptObjAll:J,getHptObjById:B}}();var KFC_Ncornermarks=function(){var A=function(){this.imageCn="";this.nameCn="";this.nameEn="";this.imageEn="";this.cornerMarkType=""};var B={};var E=function(){var I=arguments[0];var G=arguments[1];var H=new A();for(var F in I){if(H.hasOwnProperty(F)){H[F]=I[F]}}B[G]=H};var D=function(F){return B[F]};var C=function(){return B};return{add:E,getAllNco:C,getNcoById:D}}();var KFC_Promotions=function(){var R=function(){this.imagePath="";this.nameCN="";this.nameEN="";this.currentQuantity="";this.maxQuantity="";this.realPrice="";this.id="";this.pmid="";this.classId=""};var J=function(){this.id="";this.couponTitleCn="";this.couponTitleEn="";this.descEN="";this.descCN="";this.maxQuantity="";this.multiuse="";this.aNum="";this.bNum="";this.items={};this.code=""};var D=function(){this.promotionVOs=[]};var B={};var N=function(){var V=arguments[0];var W=new D();for(var a in V){if(W.hasOwnProperty(a)){W[a]=V[a];if(typeof V[a]=="object"){var U=V[a][0];var d=new J();for(var Y in U){if(d.hasOwnProperty(Y)){if(typeof U[Y]=="object"){var b=U[Y];for(var c in b){var Z=b[c];var e=new R();for(var X in Z){if(e.hasOwnProperty(X)){e[X]=Z[X]}}d[Y][Z.pmid]=e}}else{d[Y]=U[Y]}}}}}W[a]=d}B[V.menuId]=W};var I=function(){return B};var L=function(U){if(B[U]){return B[U].promotionVOs.items}return null};var S=function(U){if(B[U]){return B[U].promotionVOs.code}return""};var H=function(U){var V=0;for(var W in U.items){if(W!=null&&W!=""){V=U.items[W].currentQuantity+V}}return V};var K=function(V){var U=0;for(var W in V.items){U+=KFC_Cart.getProdNumById(W)}return U};var G=function(U){if(B[U]){return B[U].promotionVOs}return null};var M=function(){B={}};var F=function(X,V,Y){var U=G(X);var W=H(U);W++;var Z=T(U,W,X,Y);if(Z){U.items[V].currentQuantity+=1}else{base.yumAlert(property.errorPromItmesNum)}};var T=function(X,U,V,b){var Z=0;var Y=0;Z=X.aNum;Y=X.bNum;var W=0;var a=0;if(KFC_Cart.getItemNmuById(V)){W=KFC_Cart.getItemNmuById(V)}if(b){a=KFC_Products.getProductNumById(V)+W}else{a=W}if(Z!=null&&Z!=""&&Y!=null&&Y!=""){if(X.multiuse){if(parseInt(a/Z,10)>=U/Y){return true}}else{if(U<=Y&&a>=Z){return true}}}return false};var C=function(V,U){if(B[V].promotionVOs.items[U].currentQuantity<1){}else{B[V].promotionVOs.items[U].currentQuantity-=1}};var A=function(V){var U=KFC_Promotions.getAllPromotion();for(var W in U[V].promotionVOs.items){if(W!=null&&W!=""){U[V].promotionVOs.items[W].currentQuantity=0}}};var P=function(V,W){var U=L(V);U.items[W].currentQuantity=0};var O=function(W,V,Y){if(typeof Y=="string"){Y=parseInt(Y)}var U=G(W);var X=H(U)-E(W,V)+Y;var Z=T(U,X,W);if(!Z){base.yumAlert(property.errorPromItmesNum);U.items[V].currentQuantity=0;return}U.items[V].currentQuantity=Y};var E=function(W,V){var U=G(W);return U.items[V].currentQuantity};var Q=function(X,b){var U=KFC_Promotions.getPromotionVosById(X);if(!U){return""}var Z=U.items;var V=$("<div/>");var a=0;for(var Y in Z){var W=Z[Y];if(a>=3){break}V.append(KFC_HTML.getPropDatil({id:W.id,name:$.localStr({cn:W.nameCN,en:W.nameEN},1),price:W.realPrice,imagePath:W.imagePath,index_Itemp:a++,pId:X,pmid:W.pmid,isCheckPic:b}))}var c=$.localStr({cn:U.couponTitleCn,en:U.couponTitleEn},1);return KFC_HTML.getPropMain(c,V,b)};return{add:N,addHtml:Q,addPromotionNumById:F,empty:M,getAllPromotion:I,getPromItemsById:L,getPromCodeById:S,getAllPromotionZore:A,getPromotionVosById:G,getPromZoreBypromIid:P,getPromNum:H,getPromNumInCart:K,getPromItmesNumById:E,modifyPromotionNumById:O,subPromotionNumById:C,vaildPromQuantity:T}}();var KFC_Products=function(){var G=function(){this.lunch="";this.lightFlag="";this.nameCn="";this.nameEn="";this.descCn="";this.descEn="";this.imageUrl="";this.price="";this.endTime="";this.num=1;this.isPromo=0;this.p_index=0;this.systemId="";this.menuFlag="";this.maxQty="";this.saleValidDateDesc="";this.saleTimeDesc="";this.promotionAreaCn="";this.promotionAreaEn="";this.menuType="";this.validFrom="";this.validTo="";this.$li="";this.disabledFlag="";this.willSaleFlag="";this.isOrderFlag="1"};var E={};var D=function(){var T=arguments[0];var Q=arguments[1];var S=arguments[2];var R=new G();R.p_index=Q;R.$li=S;for(var P in T){if(R.hasOwnProperty(P)){R[P]=T[P]}}if(!R.imageUrl){R.imageUrl=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}R.isOrderFlag=R.lightFlag;E[T.systemId]=R};var J=function(){E={}};var K=function(){return E};var N=function(P){return E[P]};var L=function(Q){var P=K();for(var R in P){if(P[R].lunch==Q){return P[R]}}};var A=function(P,R){var Q=0;if(R=="0"){Q=1}else{Q=E[P].maxQty}if(E[P].num>=Q){base.yumAlert(property.errorOrderItemsNum.format([Q]));return}E[P].num+=1};var M=function(P){if(E[P].num<=1){base.yumAlert(property.infoMinOrderItemNum);return}E[P].num-=1};var C=function(P,Q){if(typeof Q=="string"){Q=parseInt(Q)}E[P].num=Q};var O=function(P,Q){if(typeof Q=="string"){Q=parseInt(Q)}E[P].isOrderFlag=Q};var F=function(P,Q){if(typeof Q=="string"){Q=parseInt(Q)}if(E[P]){E[P].lightFlag=Q}};var I=function(P){return E[P].num};var H=function(){if(E){for(var P in E){E[P].num=1}}};var B=function(P){if(E[P]){E[P].num=1}};return{add:D,addProductNumById:A,clearProNumOneById:B,empty:J,getAllProduct:K,getProductById:N,getProductNumById:I,getProductNumOne:H,getHalfProdByOriPId:L,modifyProductNumById:C,modifyisCHFById:F,modifyIsOrderById:O,subProductNumById:M}}();var KFC_Cart=function(){var tmpData={};var kfcProducts=KFC_Products;var cartItems={hptId:new Array()};var data=function(){var len=arguments.length;if(len==1){return tmpData[arguments[0]]}else{if(len==2){tmpData[arguments[0]]=arguments[1]}else{if(len==0){return tmpData}}}};var CartItem=function(){this.index="";this.id="";this.productId="";this.quantity="";this.promotionType="";this.itemType=""};var getHptNum=function(){var hptNum=0;if(cartItems.hptId){hptNum=cartItems.hptId.length}return hptNum};var validWowBarrelItem=function(){var cartItems=getAllCartItems();if(cartItems){for(var i in cartItems){if(cartItems[i].itemType==4){return cartItems[i]}}}return null};var executeOrder=function(data){var warningCode=KFC_Comon.initCart("/executeOrder.action",data);if(warningCode=="2"){base.yumAlert(property.WarningCode_2);return}};var executeMealItems=function(data){var warningCode=KFC_Comon.initCart("/executeMealItems.action",data);if(warningCode=="2"){base.yumAlert(property.WarningCode_2)}};var validHarfPriceProd=function(pid){var cartItems=getAllCartItems();if(cartItems){var hptPids=cartItems.hptId;for(var i=0;i<hptPids.length;i++){if(hptPids[i]==pid){return true}}}return false};var addProToCartById=function(pId){var product=kfcProducts.getProductById(pId);if(product.menuFlag=="M"){executeMealItems({productId:pId,classId:product.classExtId,quantity:product.num,objectId:product.p_index,itype:product.menuType})}else{executeOrder({classId:product.classExtId,quantity:product.num,productId:product.systemId,itype:product.menuType})}};var addProToOrderById=function(pId,pType){var c_Obj=getCartItmesById(pId,pType);var halfPNum=KFC_GlobalVar.getGlobalVarByParam("halfPriceNumber");var eachHPN=KFC_GlobalVar.getGlobalVarByParam("eachHalfPriceNum");var num=99;if(validHarfPriceProd(pId)){num=halfPNum-KFC_Cart.getHptNum();if(1>num){base.yumAlert(property.halfPriceErrorMsg.format([halfPNum]));return}if(eachHPN>-1&&c_Obj.quantity>=eachHPN){base.yumAlert(property.eachHalfPriceErrorMsg.format([eachHPN]));return}}else{if(c_Obj.quantity>=num){base.yumAlert(property.errorCartNum.format([num]));return}}c_Obj.quantity+=1;executeOrder({objectId:c_Obj.index,orderItemId:c_Obj.id,productId:c_Obj.productId,quantity:c_Obj.quantity})};var subProToOrderById=function(pId,pType){var c_Obj=getCartItmesById(pId,pType);if(c_Obj.quantity<=1){return}c_Obj.quantity-=1;executeOrder({opFlag:0,objectId:c_Obj.index,orderItemId:c_Obj.id,productId:c_Obj.productId,quantity:c_Obj.quantity})};var showPopupWithCart=function(productId,operFlag){KFC_Cart.data("operFlag",null);KFC_Cart.data("productId",null);if(!productId){return}if($.cookie(yumCfg.myNotNeed)=="true"){return}if(KFC_Promotions.getPromItemsById(productId)){if(operFlag=="sub"){var showInfo=property.reduceItemClearProm;if(KFC_Promotions.getPromCodeById(productId)=="Bucket1"){showInfo=property.reduceItemClearProm2}base.yumAlertBack(showInfo,function(){base.yumCloseLoading();KFC_PopUp_Show.pop_show(productId)})}else{base.yumCloseLoading();KFC_PopUp_Show.pop_show(productId)}}};var deletProById=function(pId,pType){var c_Obj=getCartItmesById(pId,pType);if(window._tag){_tag.dcsMultiTrack("wt.event","orderAlert","wt.msg","cancelAlert0")}base.yumConfirm(property.delOrderItem,function(){executeOrder({opFlag:0,objectId:c_Obj.index,orderItemId:c_Obj.id,productId:c_Obj.productId,quantity:0});if(window._tag){_tag.dcsMultiTrack("wt.event","orderAlert","wt.msg","cancelConfirm0")}})};var getCartItmesById=function(pId,pType){pType=pType||0;var result="";for(var k in cartItems){if(cartItems[k]){if(cartItems[k].productId==pId&&cartItems[k].promotionType==pType){result=cartItems[k];break}}}return result};var getProdNumById=function(pid){var item=null;for(var k in cartItems){if(cartItems[k]&&cartItems[k].productId==pid){item=cartItems[k];break}}return item?item.quantity:0};var getItemNmuById=function(pId){var c_Obj=getCartItmesById(pId);return c_Obj?c_Obj.quantity:0};var getAllItemNum=function(){var count=0;for(var k in cartItems){if(/^\d+$/.test(k)){count+=cartItems[k].quantity}}return count};var getAllCartItems=function(){return cartItems};var setCartItmes=function(){var args=arguments[0];var i=arguments[1];var hptId=arguments[2];var cartItem=new CartItem();cartItem.index=i;for(var k in args){if(cartItem.hasOwnProperty(k)){cartItem[k]=args[k]}}cartItems[i]=cartItem;cartItems.hptId=hptId};var cartItmesEmpty=function(){cartItems={}};var submitCart=function(){$(".right_order_menu").find(".order_btn_1").live("click",function(){$.cookie(yumCfg.orderFlag,false,{path:"/"});if(getAllItemNum()==0){base.yumAlert(property.orderItmesIsNull);return}$.ajax({type:"POST",dataType:"json",data:{},url:requestContextPath+"/vaildOrderingTime.action",async:false,beforeSend:function(XMLHttpRequest){},success:function(data,status){if(data.status&&data.status.code){if(data.status.code==serviceCode.USER_NOT_LOGIN){base.yumAlertBack(property.userNotFound,function(){base.loginExit(function(){base.setActionHttps("orderLogin.action")})});return}else{if(data.status.code==10015){base.yumAlertBack(codeMessage.limitExceeded,function(){});return}}}else{if(data.invaildText){if(data.invaildText=="storeClosed"||(data.invaildCode&&data.invaildCode==serviceCode.STORE_CLOSED)){base.yumAlertBack(property.storeClose,function(){base.setAction("returnCustomer.action")});return}if(data.isInvaildTimeFlag){if(data.invaildCode==2){base.yumAlertBack(property.WarningCode_2,function(){base.setAction("continueShopping.action")})}else{if(data.invaildCode!=null){base.yumAlertBack(eval("codeMessage.error"+data.invaildCode),function(){base.setAction("continueShopping.action")})}else{if(data.invaildText!=null){base.yumAlertBack(data.invaildText,function(){base.setAction("continueShopping.action")})}}}}else{if(data.invaildCode!=null){base.yumAlertBack(eval("codeMessage.error"+data.invaildCode),function(){base.setAction("cart.action")})}else{if(data.invaildText!=null){base.yumAlertBack(data.invaildText,function(){base.setAction("continueShopping.action")})}}}}else{base.setAction("cart.action")}}}})})};var addBeforeLoginProduce=function(){var beforeLoginClass=$.cookie(yumCfg.beforeLoginClass);var beforeLoginProduce=$.cookie(yumCfg.beforeLoginProduce);if("Y"==$("#gotoBeforeLoginClass").val()&&beforeLoginClass&&"Y"==$("#addBeforeLoginProduce").val()){KFC_Comon.initContent(beforeLoginClass)}else{KFC_Comon.initContent(KFC_Comon.getDefClassId())}if("Y"==$("#addBeforeLoginProduce").val()&&beforeLoginProduce){var topFlag=$("#topFlag");var cId=beforeLoginClass;$.ajax({url:requestContextPath+"/getMenuJson.action",type:"post",data:{classId:$.trim(cId),topFlag:topFlag.val()},dataType:"json",beforeSend:function(){base.yumOpenLoading()},success:function(o){if(o){if(KFC_Comon.vaildStatus(o.status)){return}var carnivalMenuFlag=o.carnivalMenu;var isBuy=false;if(carnivalMenuFlag!="Y"){$.each(o.nMenuVo,function(_,v){if(beforeLoginProduce==v.systemId){isBuy=true;return}})}if(isBuy||carnivalMenuFlag==="Y"){var pId=beforeLoginProduce;var proObj=KFC_Products.getProductById(beforeLoginProduce);var cNum=0;var pNum=1;var isCHF2=proObj.lightFlag;var isOrderFlag=proObj.isOrderFlag;var itype=proObj.menuType;var iMaxQty=proObj.maxQty;if(proObj.menuFlag=="V"){return}if("1"==proObj.disabledFlag||"1"==proObj.willSaleFlag){return}if(itype=="0"){iMaxQty=1}if(isCHF2=="0"){return}if(isOrderFlag=="0"){return}if(cNum+pNum>iMaxQty||pNum==0){return}if(proObj.menuFlag=="M"){executeMealItems({productId:pId,classId:proObj.classExtId,quantity:1,objectId:0,itype:proObj.menuType})}else{executeOrder({classId:proObj.classExtId,quantity:1,productId:proObj.systemId,itype:proObj.menuType})}if(window._tag){_tag.dcsMultiTrack("wt.event","orderAdd","wt.msg","txt","wt.pn_sku",pId)}}}},error:function(){base.yumAlert(property.netError)},complete:function(){base.yumCloseLoading()}})}$.cookie(yumCfg.beforeLoginProduce,null,{path:"/kfcios"});$.cookie(yumCfg.beforeLoginClass,null,{path:"/kfcios"})};return{addProToCartById:addProToCartById,addProToOrderById:addProToOrderById,cartItmesEmpty:cartItmesEmpty,deletProById:deletProById,getItemNmuById:getItemNmuById,getAllItemNum:getAllItemNum,getCartItmesById:getCartItmesById,getAllCartItems:getAllCartItems,subProToOrderById:subProToOrderById,submitCart:submitCart,setCartItmes:setCartItmes,getProdNumById:getProdNumById,showPopupWithCart:showPopupWithCart,addBeforeLoginProduce:addBeforeLoginProduce,data:data,validWowBarrelItem:validWowBarrelItem,validHarfPriceProd:validHarfPriceProd,getHptNum:getHptNum}}();var KFC_Constant={img:{prod_minus_icon:"/res/images/minus_icon_2.gif",prod_add_icon:"/res/images/add_icon_2.gif",no_pic:"no_pic.jpg",no_pic_en:"no_pic_en.jpg",cart_minus_icon:"/res/images/minus_icon.gif",cart_add_icon:"/res/images/add_icon.gif",cart_del_icon:"/res/images/delete_icon.gif",wordLink_hot:"/res/images/hot.png",wordLink_new:"/res/images/new.png",pop_minus_icon:"/res/images/minus_icon_3.gif",pop_add_icon:"/res/images/add_icon_3.gif",pop_close_icon:"/res/images/close_icon.png",pop_close_icon02:"/res/images/close02.png",pop_btn_Order:"/res/images/popup_btn_2.png",pop_btn_Order_en:"/res/images/en/popup_btn_2.png",pop_btn_noOrder:"/res/images/popup_btn_2_noOrder.png",pop_btn_noOrder_en:"/res/images/en/popup_btn_2_noOrder.png",pop_btn_notNeed:"/res/images/popup_btn_1.png",pop_btn_notNeed_en:"/res/images/en/popup_btn_1.png",pop_banner_close:"res/images/closeBtn.gif",pop_btn_timeArrived:"/res/images/pop_btn_timeArrived.png",pop_btn_timeArrived_en:"/res/images/en/pop_btn_timeArrived.png"}};var KFC_HTML=function(){var G=KFC_Products;var C=KFC_Cart;var O=KFC_Promotions;var j=KFC_GlobalVar;var I=KFC_Status;var B=KFC_Ncornermarks;var X="javascript:;";var Ae="<li/>",U='<div href="'+X+'" class="showPicPop showPP_IE7"/>',V='<div class="pro_info"/>',An='<a href="'+X+'" class="pro_name">{0}</a>',Af="<p/>",Am='<span class="pro_price">{0}'+pageMessage.home_Per+" </span>",d="<span/>",F='<a href="'+X+'"><img src="{0}'+KFC_Constant.img.prod_minus_icon+'"/></a>',Ac='<input type="text" id="{0}" value="1" maxlength="2"/>',q='<a href="'+X+'"><img src="{0}'+KFC_Constant.img.prod_add_icon+'"/></a>',A='<input type="button" />',u='<img src="{0}" />';var Ak=function(AD){var AH=AD.id;var AB=AD.menuType;var AE=AD.imageUrl?AD.imageUrl:$.localStr({cn:KFC_Constant.img.no_pic,en:KFC_Constant.img.no_pic_en},1);var Az=AD.name;var AO=AD.menuFlag;var A1=$.moneyFormat(computationPrice(AD.price));var AS=AD.lightFlag;var AX=AD.virtualLink;var AR=AD.virtualLinkClass;var AL=AD.descCn;var AJ=AD.descEn;var Av=AD.couponDescCn;var At=AD.couponDescEn;var AK=AD.virtualLinkType;var Au=AD.disabledFlag;var A0=AD.willSaleFlag;var AT=j.getGlobalVarByParam("base");var p=j.getGlobalVarByParam("httpCornerMarkPath");var A6=j.getGlobalVarByParam("httpVersionPath");var AZ=AD.linkShowType||0;var Ay=j.getGlobalVarByParam("halfPriceNumber");var Aq=AD.index;var AG=B.getNcoById(AH);var A5=$(Ae);var AU=$(u.format([A6+AE]));var AN="";var AQ=$(Am.format([A1]));var AY=$(F.format([AT]));var AA=$(Ac.format([AH]));var AM=$(q.format([AT]));var A4=$(Af).addClass("p_clear_both");var AC=$(A);var AI=$(Af).addClass("p_ta_center");var A2="";if(AB=="0"){AA.addClass("pro_number_input3").attr("readonly","readonly");A2=$(d).addClass("pro_number").append(AA)}else{AA.addClass("pro_number_input");A2=$(d).addClass("pro_number").append(AY,AA,AM)}var Ax=$(U).append(AU);var AP=$(Af).append(AQ,A2);var AF="";var a="";if(AO=="V"){if(Aq==0&&AZ==1){if(AS=="1"){a=$(Af);A5.width("558px").height("135").css("border","0px");AU.width("559px").height("135")}else{return}}else{if(AK==1){AN=$(An.format([Az]));a=$('<p style="min-height:55px;">').append(AN);AC=AC.addClass("order_btn");AF=$(V).append(a,A4.append(AC))}else{if(AS=="1"){AN=$(An.format([$.localStr({cn:AL,en:AJ},1)]));a=$(Af).addClass("p_h60px").append(AN);AF=$(V).append(a,AI.append(AC.addClass("see_details_btn")))}else{return}}}}else{AN=$(An.format([Az]));a=$(Af).append(AN);if("CN"==$.localStr({cn:"CN",en:""},1)){if($.localStr({cn:Av,en:At},1)){a=a.append($('<span class="couponDesc">'+$.localStr({cn:Av,en:At},1)+"</span>"))}else{a=a.append($('<span class="couponDesc">&nbsp;</span>'))}}AC=AC.addClass("order_btn");if(AS=="0"){AC=AC.addClass("order_btn_h");if("1"==Au){AC=AC.addClass("order_btn_h")}else{if("1"==A0){AC=AC.addClass("timeArrived_btn")}}}AF=$(V).append(a,AP,A4.append(AC))}if(AS=="0"&&"1"==Au){var A3=$(u.format([AT+$.localStr({cn:"/res/images/isOutOfStock.png",en:"/res/images/en/isOutOfStock.png"},1)])).width("179px").height("153px");AV=$(d).addClass("ersee_superscript_img").append(A3);Ax.append(AV)}else{if(AG){var AW=AG.imageEn;var Aw=AG.cornerMarkType;var Ap=AG.nameCn;var Ar=AG.nameEn;var AV="";if(Aw==1){var A3=$(u.format([p+AW])).width("179px").height("153px");AV=$(d).addClass("ersee_superscript_img").append(A3)}else{var As=$.localStr({cn:Ap,en:Ar},1);AV=$(d).addClass("ersee_superscript_txt red yellow gray").text(As)}Ax.append(AV)}}Ax.click(function(){if(AO=="V"){if(Aq==0&&AZ==1){if(AX.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(AX)}}else{if(AK==1){if(window._tag){_tag.dcsMultiTrack("wt.event","menu","wt.msg",AD.name)}KFC_Comon.initContent(AR)}else{if(AK==2){if(AX.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(AX)}}}}}else{KFC_PopUp_Show.pop_show(AH,true)}});AI.click(function(){if(Aq!=0&&AZ!=1){if(AK==1){if(window._tag){_tag.dcsMultiTrack("wt.event","menu","wt.msg",AD.name)}KFC_Comon.initContent(AR)}else{if(AK==2){if(AX.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(AX)}}}}});a.click(function(){if(AO=="V"){AI.click()}});AY.click(function(){G.subProductNumById(AH);AA.val(G.getProductById(AH).num)});AM.click(function(){G.addProductNumById(AH,AB);AA.val(G.getProductById(AH).num)});AC.click(function(){if(AO=="V"){if(AK==1){if(window._tag){_tag.dcsMultiTrack("wt.event","menu","wt.msg",AD.name)}KFC_Comon.initContent(AR)}return}var A7=C.getItemNmuById(AH);var A9=G.getProductById(AH);var Bb=A9.num;var Bc=A9.lightFlag;var A8=A9.isOrderFlag;var Bd=A9.menuType;var Ba=A9.maxQty;if("1"==Au||"1"==A0){return}if(Bd=="0"){Ba=Ay-KFC_Cart.getHptNum()}if(Bc=="0"){return}if(A8=="0"){return}if(Bd=="0"){if(Bb>Ba||Bb==0){G.modifyProductNumById(AH,1);AA.val(G.getProductById(AH).num);base.yumAlert(property.errorOrderItemsNum.format([Ba]));return}}else{if(A7+Bb>Ba||Bb==0){G.modifyProductNumById(AH,1);AA.val(G.getProductById(AH).num);base.yumAlert(property.errorOrderItemsNum.format([Ba]));return}}C.addProToCartById(AH);if(window._tag){_tag.dcsMultiTrack("wt.event","orderAdd","wt.msg","txt","wt.pn_sku",AH)}if(I.getStatus().code&&I.getStatus().code!=serviceCode.SUC_CODE){return}if($.cookie(yumCfg.myNotNeed)=="true"){return}if(KFC_Promotions.getPromItemsById(AH)){base.yumCloseLoading();KFC_PopUp_Show.pop_show(AH)}});AA.keyup(function(){var A7=this.value;if(!/^[\d]{1,2}$/.test(String(A7))){this.value=1;return}G.modifyProductNumById(AH,A7)});return A5.append(Ax,AF)};var M="<tr/>",Z="<td/>",g='<td class="order_table_td1"/>',c='<td class="order_table_td2"  style="text-align:left">{0}</td>',t='<a href="'+X+'"><img src="{0}'+KFC_Constant.img.cart_minus_icon+'"></a>',z='<span class="ft_b">{0}</span>',e='<a href="'+X+'"><img src="{0}'+KFC_Constant.img.cart_add_icon+'"></a>',l='<td class="order_table_td3" >{0}</td>',N='<a href="'+X+'"><img src="{0}'+KFC_Constant.img.cart_del_icon+'"></a>',x='<span class="order_price">'+pageMessage.subtotal+':<em>{0}</em></span><span class="order_price">'+pageMessage.deliverFee+'<font color="red">{1}</font>:<em>{2}</em></span>',L='<span class="netUser_price">'+property.promotionNotice+"</span>",S='<span class="order_price">'+pageMessage.total+":<em>{0}</em></span>";var Aj=function(a){$($(".Price")[0]).html(computationPrice(a.subtotal));$($(".Price")[1]).html(computationPrice(a.deliverFee));$($(".Price")[3]).html(computationPrice(a.totalProvince));if(0==Number(a.totalProvince)){$($(".Price")[3]).hide();$($(".Price")[3]).prev().hide()}else{$($(".Price")[3]).hide();$($(".Price")[3]).prev().hide()}$("#prodesc").html(a.cartRemark);if(a.channelName){$("#netUser_price").html(property.promotionNotice);$("#netUser_price").show()}else{$("#netUser_price").html("");$("#netUser_price").hide()}$($(".Price")[2]).html(computationPrice(a.total))};var Ad=function(Av){var AE=Av.id,Ap=Av.name,AH=computationPrice(Av.price),Ar=Av.num,At=Av.isPromo,AG=j.getGlobalVarByParam("base"),AF=Av.isAutoPromo,AI=computationPrice(Av.realPrice),Aq=Av.itype,Ay=Av.itemType;var AA=$('<div class="pro_title">{0}</div>'.format([Ap])),Aw=$('<div class="del"><a href="javascript:void(0);"></a></div>'),a=$('<div class="pro_numbers">'),Au="";if(At||Ay==4){var Ax=$("<label>{0}{1}</label>".format([Ar,pageMessage.fen]));a.append(Ax);Au=$('<div class="price">{0}</div>'.format([AI]))}else{var AD="";var As="";var p="";var AB="";if(1==Ar){AD="minus_icon_2s_dis.gif";p='style="cursor: default;"'}else{AD="minus_icon_2s.gif";p='style="cursor: pointer;"'}if(99==Ar){As="plus_icon_2s_dis.gif";AB='style="cursor: default;"'}else{As="plus_icon_2s.gif";AB='style="cursor: pointer;"'}var AC=$('<a href="javascript:void(0);" {0} class="doMinus"><img src="{1}/res/images/{2}"></a>'.format([p,AG,AD])),Ax=$('<input type="text" class="pro_numbers_input" value="{0}" maxlength="2" disabled="disabled" onkeyup="this.value=this.value.replace(/D/g,\'\');">'.format([Ar])),Az=$('<a href="javascript:void(0);" {0} class="doPlus"><img src="{1}/res/images/{2}"></a>'.format([AB,AG,As]));a.append(AC,Ax,Az);Au=$('<div class="price">{0}</div>'.format([AH]));AC.click(function(){KFC_Cart.data("operFlag","sub");KFC_Cart.data("productId",AE);C.subProToOrderById(AE,At)});Az.click(function(){KFC_Cart.data("operFlag","add");KFC_Cart.data("productId",AE);C.addProToOrderById(AE,At)})}Aw.click(function(){KFC_Cart.data("operFlag","del");C.deletProById(AE,At)});return $("<li>").append(AA,Aw,a,Au)};var m="<a />",y='<img width="558" height="354" src="{0}"/>',D='<img width="274" height="140" src="{0}"/>',Q='<img width="558" height="354" src="{0}"/>';pop_banner='<img src="{0}"/>',banner_div="<div/>";var Aa=function(Av){var Au=Av.imageUrl;var AA=Av.linkedUrl;var AF=Av.classId;var AE=Av.linkType;var a=Av.smallPictureUrl;var p=Av.isPopup;var AB=Av.title;var As=j.getGlobalVarByParam("base");var AC=$(banner_div);var AD=$(banner_div).addClass("bannerPopupBg").css("display","none");var Ar=$(banner_div).addClass("bannerPopup").css("display","none");var Az=$(banner_div).addClass("bannerPopupSmall").css("display","none");var Ax=$(m);var Aw=$(pop_banner.format([Au]));var Ap=$(pop_banner.format([a]));var Ay=$(pop_banner.format([As+"/"+KFC_Constant.img.pop_banner_close])).addClass("closeBannerPopup");var Aq=$(pop_banner.format([As+"/"+KFC_Constant.img.pop_banner_close])).addClass("closeBannerPopupSmall");Ax.append(Aw);Ar.append(Ax,Ay);Az.append(Ap,Aq);AC.append(AD,Ar,Az);Az.click(function(){if($.browser.msie&&$.browser.version==6){AD.height($(document).height()).width($(document).width())}AD.show();Ar.show().css("left",($(document).width()-Ar.width())/2);Az.hide()});Ax.click(function(){if(AE==1){if(window._tag){_tag.dcsMultiTrack("wt.event","首页超链接","wt.msg",AB)}KFC_Comon.initContent(AF,"wowBarrel_PopOut")}else{if(AE==2){if(AA.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(AA,"","")}}}});AD.click(function(){At()});Ay.click(function(){At()});var At=function(){AD.hide();Ar.hide();Az.show()};Aq.click(function(AG){AG.stopPropagation();Az.hide();popBannerClose=false});return AC};var Ag=function(Ap){var AA=Ap.imageUrl;var Az=Ap.type;var Av=Ap.position;var p=Ap.linkedUrl;var Aq=Ap.classId;var Au=Ap.linkType;var Ax=Ap.title;var a=Ap.bflag;var Aw=Ap.lflag;var At=Ap.rflag;var Ay=Ap.bigOrder;var AC=$(m);var Ar=$(y.format([AA]));var As=$(D.format([AA]));var AB=$(Q.format([AA]));if(Az==1){if(Ay==1){AC.addClass("kv_C_a").append(Ar)}else{AC=$('<a style="display:none;"/>');AC.addClass("kv_C_a").append(AB)}}else{if(Av==1){if(Aw<1){AC.addClass("fl_l").append(As)}}else{if(At<1){AC.addClass("fl_r").append(As)}}}AC.click(function(){if(Au==1){if(window._tag){_tag.dcsMultiTrack("wt.event","首页超链接","wt.msg",Ax)}KFC_Comon.initContent(Aq,"wowBarrel_Banner")}else{if(Au==2){if(p.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(p,"","")}}}});return AC};var w=function(As){if(typeof As=="string"){As=parseInt(As)}var Ar='<div id="kvNav" class="kvNav"/>',p='<a class="trigger imgSelected" href="javascript:void(0);">{0}</a>',At='<a class="trigger" href="javascript:void(0);">{0}</a>';var Ap=$(Ar);for(var Aq=1;Aq<=As;Aq++){if(Aq>6){break}if(Aq==1){var a=$(p.format([Aq]))}else{var a=$(At.format([Aq]))}Ap.append(a)}return Ap};var r='<p onclick="wlClick({0},{1})"/>',b="<a/>",s="<img/>",i="<span/>";var Ah=function(p){var a=p.rType;var Ar=p.linkCid;var Ay=p.linkUrl;var At=p.titleCn;var Ap=p.titleEn;var Aw=p.textCn;var Au=p.textEn;var AC=p.textType;var Az=j.getGlobalVarByParam("base");var Av=Az+KFC_Constant.img.wordLink_hot;var Aq=Az+KFC_Constant.img.wordLink_new;var AB;if(AC==1){AB=$(s).attr("src",Av)}else{AB=$(s).attr("src",Aq)}var Ax=$(i).text(property.moreDetail);var AA=$(b).attr("title",$.localStr({cn:At,en:Ap},1)).text($.localStr({cn:Aw,en:Au},1)+" ").append(AB,Ax);var As="";if(a==2){As="'"+Ay+"'"}else{if(a==1){As=Ar}}return $(r.format([a,As])).append(AA)};var v="<p/>",W="<a/>",h="<li/>",Ao="<ul/>",Ab="<img/>",f="<div/>",K="<span/>",o="<h4/>",Ai='<input id="notWarn" type="checkbox" value="" /> ',E='<label for="notWarn">&nbsp;'+property.noWarn+"</label>",n='<input type="text" value="1" maxlength="2" />';var H=function(p,a,At){var As=$(f).addClass("popup_main_title_product");var Au=$(f).addClass("popup_main_product");var Ap=$(Ao);Ap.append(a);Au.append(Ap);var Ar=p;var Aq="";if(At){Aq=$(f).addClass("popup_main_title");Aq.append(Ar);return As.append(Aq,Au)}else{var Av=$("<span>").html(property.couponTitleAdd+"<br/>"+property.couponTitleUse);Av.addClass("popup_main_title_span");Aq=$("<h4>").addClass("popup_main_title");Aq.append(Ar);return As.append(Av,Aq,Au)}};var T=function(Aw){var AB=Aw.pId;var AC=Aw.imagePath?Aw.imagePath:KFC_Constant.img.no_pic;var p=Aw.name;var Ay=Aw.index_Itemp;var a=Aw.pmid;var At=j.getGlobalVarByParam("base");var AD=j.getGlobalVarByParam("httpVersionPath");var As=Aw.isCheckPic;var Aq=$(h);var AA=$(Ab).attr("src",AD+AC);var Av=$(K).addClass("ImgBox").append(AA);var Ar=$(K).addClass("popup_txt").text(p);var Ap=$(W).addClass("doMinus").attr("href",X).append($("<img></img>").attr("src",At+KFC_Constant.img.pop_minus_icon));var Au=$(n).addClass("pro_number_input2").attr("productId",AB).val(0);var Az=$(W).addClass("doPlus").attr("href",X).append($("<img></img>").attr("src",At+KFC_Constant.img.pop_add_icon));var Ax=$(K).addClass("product_number").append(Ap,Au,Az);Ap.click(function(){O.subPromotionNumById(AB,a);Au.val(O.getPromItemsById(AB)[a].currentQuantity)});Az.click(function(){O.addPromotionNumById(AB,a,As);Au.val(O.getPromItemsById(AB)[a].currentQuantity)});Au.keyup(function(){var AE=this.value;if(!/^[\d]{1,2}$/.test(String(AE))){this.value=1;return}O.modifyPromotionNumById(AB,a,AE);Au.val(O.getPromItmesNumById(AB,a))});return Aq.append(Av,Ar,Ax)};var P=function(AG){var AM=G.getProductById(AG);var AH=B.getNcoById(AG);var AK=j.getGlobalVarByParam("httpVersionPath");var Au=j.getGlobalVarByParam("base");var p=j.getGlobalVarByParam("httpCornerMarkPath");var At=$.moneyFormat(computationPrice(AM.price));var AF=$(d).addClass("price").text(At+pageMessage.home_Per);var AD=$(Ab).attr("src",Au+KFC_Constant.img.pop_minus_icon);var Ay=$(W).addClass("doMinus").attr("href",X).append(AD);var Aq=$(n).addClass("pro_number_input2").val(AM.num);var AA=$(Ab).attr("src",Au+KFC_Constant.img.pop_add_icon);var AL=$(W).addClass("doPlus").attr("href",X).append(AA);var As="";if(AM.menuType=="0"){Aq.attr("readonly","readonly");As=$(K).addClass("product_number").append(Aq)}else{As=$(K).addClass("product_number").append(Ay,Aq,AL)}var Ar=$(f).addClass("price_span_1").append(AF,As);var AE=$(Ab).attr("src",AK+AM.imageUrl);var AN=$(f).addClass("popup_product_detail_img");if("0"==AM.lightFlag&&"1"==AM.disabledFlag){var Az="";var Ax=$(Ab).attr("src",Au+$.localStr({cn:"/res/images/isOutOfStock.png",en:"/res/images/en/isOutOfStock.png"},1)).width("130px").height("111px");Az=$(d).addClass("ersee_superscript_img").append(Ax);AN.append(AE,Az)}else{if(AH){var Az="";if(AH.cornerMarkType==1){var Ax=$(Ab).attr("src",p+AH.imageEn).width("130px").height("111px");Az=$(d).addClass("ersee_superscript_img").append(Ax)}else{var a=$.localStr({cn:AH.nameCn,en:AH.nameEn},1);Az=$(d).addClass("nco").text(a)}AN.append(AE,Az)}else{AN.append(AE)}}var Ap=$(o).text($.localStr({cn:AM.nameCn,en:AM.nameEn},1));var AJ=$(v).text($.localStr({cn:AM.descCn,en:AM.descEn},1));var Av=$(v).text(property.avaliableTime+AM.saleTimeDesc);var Aw=$(v).text(property.avaliableDate+AM.saleValidDateDesc);var AB=$(v).text(property.avaliableZone+$.localStr({cn:AM.promotionAreaCn,en:AM.promotionAreaEn?AM.promotionAreaEn:""},1));var AC=$(f).addClass("detail_txt").append(AJ,Av,Aw,AB);var AI=$(f).addClass("popup_product_detail_txt").append(Ap,AC);AL.click(function(){G.addProductNumById(AG,AM.menuType);Aq.val(G.getProductNumById(AG))});Ay.click(function(){G.subProductNumById(AG);Aq.val(G.getProductNumById(AG));var AP=O.getPromotionVosById(AG);var AQ=O.getPromNum(AP);var AO=O.vaildPromQuantity(AP,AQ,AG);if(!AO){$("input[productId="+AG+"]").val(0);for(var AR in AP.items){AP.items[AR].currentQuantity=0}}});Aq.keyup(function(){var AO=this.value;if(!/^[\d]{1,2}$/.test(String(AO))){this.value=1;return}G.modifyProductNumById(AG,AO)});return $(f).append(AN,AI,Ar)};var R=function(AI,Au,AF,At){var Av=j.getGlobalVarByParam("base");var p=G.getProductById(AF);var Az=p?p.isOrderFlag:"1";var AD=$(Ab).attr("src",function(){if(AI==""){return Av+KFC_Constant.img.pop_close_icon02}else{return Av+KFC_Constant.img.pop_close_icon}});var a=$(W);var Ay=$(v).addClass("close_icon").append(a.append(AD));var Aw=$(f);if(AI){Aw.addClass("popup_product_detail").append(AI)}var AC=$(f);if(Au){AC.addClass("propmDetail").append(Au)}var AK=$(f).addClass("clear");var AA=$(v).addClass("popup_btn");if(AI){var AL=true;var AJ=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_Order,en:KFC_Constant.img.pop_btn_Order_en},1));if(Az=="0"){AJ=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_noOrder,en:KFC_Constant.img.pop_btn_noOrder_en},1));if("1"==p.disabledFlag){AJ=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_noOrder,en:KFC_Constant.img.pop_btn_noOrder_en},1))}else{if("1"==p.willSaleFlag){AJ=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_timeArrived,en:KFC_Constant.img.pop_btn_timeArrived_en},1))}}}var AE=$(W).addClass("orderBtn").attr("href",X);AA.append(AE.append(AJ));$(AE).unbind().click(function(){if("1"==p.disabledFlag||"1"==p.willSaleFlag){return}if(Az=="0"){return}if(window._tag){_tag.dcsMultiTrack("wt.event","orderAdd","wt.msg","pic","wt.pn_sku",AF)}KFC_PopUp_Show.OrderSubmit(AF,AL);KFC_Comon.initPropAndPromToNum(AF);KFC_dialog.close_dialog(At)})}else{var Ap=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_notNeed,en:KFC_Constant.img.pop_btn_notNeed_en},1));var Ax=$(Ab).attr("src",Av+$.localStr({cn:KFC_Constant.img.pop_btn_Order,en:KFC_Constant.img.pop_btn_Order_en},1));var Aq=$(W).addClass("not_need").attr("href",X);var AH=$(W).addClass("pro_submit").attr("href",X);var As=$(Ai);var AB=$(E);var AG=$(Af).addClass("check").append(As,AB);AA.append(Aq.append(Ap),AH.append(Ax)).after(AG);As.click(function(){KFC_dialog.myNotNeed($(this).is(":checked"))});Aq.unbind().click(function(){KFC_Comon.initPropAndPromToNum(AF);KFC_dialog.close_dialog(At)});AH.unbind().click(function(){var AM=O.getPromotionVosById(AF);if(!KFC_Promotions.getPromNum(AM)){base.yumAlert(property.promItemNumIsNull);return}KFC_PopUp_Show.OrderSubmit(AF);KFC_Comon.initPropAndPromToNum(AF);if(window._tag){_tag.dcsMultiTrack("wt.event","popPromotion","wt.pn_sk",AM.id)}KFC_dialog.close_dialog(At)})}var Ar=$(f);AD.unbind().click(function(){KFC_Comon.initPropAndPromToNum(AF);KFC_dialog.close_dialog("#popupCon")});return Ar.append(Ay,Aw,AC,AK,AA)};var Al=function(As){var Au=As.disabledFlag;var AP=As.willSaleFlag;var AC=j.getGlobalVarByParam("base");var p=j.getGlobalVarByParam("httpCornerMarkPath");var AU=j.getGlobalVarByParam("httpVersionPath");var AA=j.getGlobalVarByParam("halfPriceNumber");var AD=As.systemId;var AQ=$('<div id="sinP{0}" class="single_pro" />'.format([As.systemId]));var AJ=As.imageUrl;if(!AJ){AJ=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var AR=$('<div class="pro_img" />');var Ap=$('<img class="prod_pic" src="{0}"/>'.format([AU+AJ]));AR.append(Ap);var AT=$('<div class="pro_info" />');var At=$("<h4>{0}</h4>".format([$.localStr({cn:As.nameCn,en:As.nameEn},1)]));AT.append(At);var a=$('<p class="mt2px min_height"> {0} </p>'.format([$.localStr({cn:As.descCn,en:As.descEn},1)]));AT.append(a);var AH=$('<p class="mt2px">{0}{1}</p>'.format([property.avaliableTime,As.saleTimeDesc]));AT.append(AH);var AM=$('<p class="mt2px">{0}{1}</p>'.format([property.avaliableDate,As.saleValidDateDesc]));AT.append(AM);var Ax=$('<p class="mt2px">{0}{1}</p>'.format([property.avaliableZone,$.localStr({cn:As.promotionAreaCn,en:As.promotionAreaEn},1)]));AT.append(Ax);var Av=$("<p/>");var AO=$('<input type="button">');AO.addClass("order_btn");if("0"==As.lightFlag){AO.addClass("order_btn_h");if("1"==Au){AO.addClass("order_btn_h")}else{if("1"==AP){AO.addClass("timeArrived_btn")}}}if("0"==As.menuType&&C.getAllCartItems()&&KFC_Cart.getHptNum()>=AA){AO.addClass("order_btn_h")}Av.append(AO);var AI=$('<span class="pro_price"><font class="red">{0}</font>{1}</span>'.format([computationPrice(As.price),pageMessage.Yuan_Per]));Av.append(AI);var AB=$('<span class="pro_number"/>');if(As.menuType!="0"){var AF=$('<a href="javascript:void(0)"><img  src="{0}/res/images/minus_icon_2.gif" /></a>'.format([j.getGlobalVarByParam("base")]));AB.append(AF)}var Az="";if(As.menuType!="0"){Az='<input type="text" class="pro_number_input" value="1" maxlength="2" />'}else{if(As.menuType=="0"){Az='<input type="text" class="pro_number_input" value="1" maxlength="2" disabled="disabled" />'}}var AN=$(Az);AB.append(AN);if(As.menuType!="0"){var AG=$('<a href="javascript:void(0)"><img src="{0}/res/images/add_icon._2.gif"/></a>'.format([j.getGlobalVarByParam("base")]));AB.append(AG)}Av.append(AB);AT.append(Av);AQ.append(AR);AQ.append(AT);var Aw=B.getNcoById(AD);if("0"==As.lightFlag&&"1"==Au){var AS=$(u.format([AC+$.localStr({cn:"/res/images/isOutOfStock.png",en:"/res/images/en/isOutOfStock.png"},1)])).width("179px").height("153px");AK=$(d).addClass("ersee_superscript_img").append(AS);AR.append(AK)}else{if(Aw){var AL=Aw.imageEn;var Ay=Aw.cornerMarkType;var Aq=Aw.nameCn;var Ar=Aw.nameEn;var AK="";if(Ay==1){var AS=$(u.format([p+AL])).width("179px").height("153px");AK=$(d).addClass("ersee_superscript_img").append(AS)}else{var AE=$.localStr({cn:Aq,en:Ar},1);AK=$(d).addClass("ersee_superscript_txt red yellow gray").text(AE)}AR.append(AK)}}if(AG){AG.click(function(){G.addProductNumById(AD,As.menuType);AN.val(G.getProductNumById(AD))})}if(AF){AF.click(function(){G.subProductNumById(AD);AN.val(G.getProductNumById(AD))})}AN.keyup(function(){var AV=this.value;if(!/^[\d]{1,2}$/.test(String(AV))){this.value=1;return}G.modifyProductNumById(AD,AV)});AR.click(function(){KFC_PopUp_Show.pop_show(AD,true)});AO.click(function(){if(As.menuFlag=="V"){return}var AV=C.getItemNmuById(AD);var AX=G.getProductById(AD);var AZ=AX.num;var A0=As.lightFlag;var AW=As.isOrderFlag;var A1=As.menuType;var AY=As.maxQty;if("0"==A1&&C.getAllCartItems()&&KFC_Cart.getHptNum()>=AA){AW="0"}else{AW="1"}if(A1=="0"){AY=AA-KFC_Cart.getHptNum()}if("1"==Au||"1"==AP){return}if(A0=="0"){return}if(AW=="0"){return}if(AO.hasClass("order_btn_h")){return}if(A1=="0"){if(AZ>AY||AZ==0){G.modifyProductNumById(AD,1);AN.val(G.getProductById(AD).num);base.yumAlert(property.errorOrderItemsNum.format([AY]));return}}else{if(AV+AZ>AY||AZ==0){G.modifyProductNumById(AD,1);AN.val(G.getProductById(AD).num);base.yumAlert(property.errorOrderItemsNum.format([AY]));return}}C.addProToCartById(AD);if(I.getStatus().code&&I.getStatus().code!=serviceCode.SUC_CODE){return}if($.cookie(yumCfg.myNotNeed)=="true"){return}if(O.getPromItemsById(AD)){base.yumCloseLoading();KFC_PopUp_Show.pop_show(AD)}});return AQ};var J=function(As){var a=$(As.order.collects).size()==0?0:1;var Aq=$(As.order.kfcPromotions).size();$("#cart_promotion_list").html("");if(0==Aq&&0==a){$(".cart_promotion").hide();if("cn"==$.localStr({cn:"cn",en:"en"},1)){$(".order_detail").css("height","265px")}else{$(".order_detail").css("height","255px")}}else{$(".cart_promotion").show();if("cn"==$.localStr({cn:"cn",en:"en"},1)){$(".order_detail").css("height","167px")}else{$(".order_detail").css("height","157px")}if(1==a){var At=As.order.collects[0].listCollectPromotionVo;var p=$.localStr({cn:At[0].couponTitleCn,en:At[0].couponTitleEn},1);var Au=Number(At[0].balance)/100;var Ar='<span class="Til2">{0}'+property.balance+"</span>";Ar=Ar.format([p,Au]);var Ap=$("<li>").append($(Ar));$("#cart_promotion_list").append(Ap)}if(0!=Aq){$.each(As.order.kfcPromotions,function(Aw,Ax){if((9-a+1)>Aw){var Av=$.localStr({cn:Ax.couponTitleCn,en:Ax.couponTitleEn},1);var Ay=$("<li>").append($('<span class="Til">{0}</span>'.format([Av])));if(Ax.showMode==1){Ay.append($('<span class="other01"><a promid="{0}" prodid="" name="addPromotion" href="javascript:void();"></a></span>'.format([Ax.id])))}else{if(1==Ax.items.length&&1==Ax.maxQuantity){Ay.append($('<span class="other01"><a promid="{0}" prodid="{1}" name="addPromotion" href="javascript:void();"></a></span>'.format([Ax.id,Ax.items[0].pmid])))}else{Ay.append($('<span class="other02"><a promid="{0}" name="promotionDetail" href="javascript:void();" class="P_layer_bf"></a></span>'.format([Ax.id])))}}$("#cart_promotion_list").append(Ay)}else{return false}});$("[name=addPromotion]").click(function(){var Az='{"count":{0},"promotionId":{1},"name":"","classId":"","promotionItemId":"{2}","isMeal":0}';var Av='{"productId":"","count":"","items":[{0}]}';var Ax=$(this).attr("promid");var Aw=1;var Ay=$(this).attr("prodid");var AA=Av.format([Az.format([Aw,Ax,Ay])]);KFC_Comon.initCart("/executeCartPromo.action",{jsonStr:AA});if(window._tag){_tag.dcsMultiTrack("wt.event","cartPromotion","wt.pn_sk",Ax)}});$("[name=promotionDetail]").click(function(){var Ay=$(this).attr("promid");var AC=null;$.each(As.order.kfcPromotions,function(AI,AJ){if(Ay==AJ.id){AC=AJ}});if(null!=AC){var AE=$.localStr({cn:AC.couponTitleCn,en:AC.couponTitleEn},1),AB=$("#cart_prom_pop").html();$("<div id='pop_cart_prom' style='overflow:hidden'>").append(AB).dialog({resizable:false,height:"auto",width:582,draggable:false,fixed:false,position:{my:"center",at:"center",of:window,collision:"fit"},modal:true,open:function(){$(this).find("#popbox_bf").removeAttr("style").show()}});$("#pop_cart_prom").height(450);$("#pop_cart_prom").find("#cart_prom_title").html(AE);$("#pop_cart_prom").find("#prod_list").attr("curnum",AC.currentQuantity);var AA=$("#pop_cart_prom").find("#prod_list").html();$("#pop_cart_prom").find("#prod_list").html("");var AH=$(AC.items).size()>3?3:$(AC.items).size();for(var Ax=0;Ax<AH;Ax++){var AF=AC.items[Ax],Av=$.localStr({cn:AF.nameCN,en:AF.nameEN},1),Az=AF.imagePath,AD=j.getGlobalVarByParam("httpVersionPath"),AG='<img src="{0}{1}">'.format([AD,Az]),Aw=$(AA).attr("pitid",AF.pmid);Aw.find(".ImgBox").html(AG);Aw.find(".Til").html(Av);$("#pop_cart_prom").find("#prod_list").append(Aw)}$("#pop_cart_prom").find("ul").attr("maxnum",AC.maxQuantity);$("#pop_cart_prom").find(".close02").click(function(){$("#pop_cart_prom").dialog("close");$("#pop_cart_prom").remove()});$("#pop_cart_prom").find(".layerorder_btn02").click(function(){$("#pop_cart_prom").dialog("close");$("#pop_cart_prom").remove()});$("#pop_cart_prom").find(".doMinus").click(function(){var AI=$(this).next(".pro_number_input");var AJ=$(this).parents("ul");if(0!=Number(AI.val())){AI.val(Number(AI.val())-1);AJ.attr("curnum",Number(AJ.attr("curnum"))-1)}Y()});$("#pop_cart_prom").find(".doPlus").click(function(){var AI=$(this).prev(".pro_number_input");var AJ=$(this).parents("ul");if(Number(AJ.attr("curnum"))+1<=Number(AJ.attr("maxnum"))){AI.val(Number(AI.val())+1);AJ.attr("curnum",Number(AJ.attr("curnum"))+1)}Y()});$("#pop_cart_prom").find(".layerorder_btn").click(function(){var AK='{"count":{0},"promotionId":{1},"name":"","classId":"","promotionItemId":"{2}","isMeal":0}';var AI='{"productId":"","count":"","items":[{0}]}';var AL="";var AJ=[];$("#pop_cart_prom").find("#prod_list").find("li").each(function(){var AM=$(this).find("input").val();if(AM!=0){var AN=$(this).attr("pitid");AJ.push(AK.format([AM,Ay,AN]))}});if(AJ.length==0){base.yumAlert(property.infoMinOrderItemNum);return}AL=AI.format([AJ.join(",")]);$("#pop_cart_prom").dialog("close");$("#pop_cart_prom").remove();KFC_Comon.initCart("/executeCartPromo.action",{jsonStr:AL});if(window._tag){_tag.dcsMultiTrack("wt.event","cartPromotion","wt.pn_sk",Ay)}})}})}}};var Y=function(){var p=0;var a="";$("#pop_cart_prom").find(".pro_number").each(function(){var As=$(this),Aq=Number(As.children(".pro_number_input").val()),Ar=As.children(".doMinus").children(),Ap=Ar.attr("src");if(!a){a=Ap.substring(0,Ap.lastIndexOf("/"))}if(0==Aq){Ar.attr("src",a+"/minus_icon_2_dis.gif")}else{Ar.attr("src",a+"/minus_icon_2.gif")}p+=Aq});if(p==Number($("#pop_cart_prom").find("ul").attr("maxnum"))){$("#pop_cart_prom").find(".doPlus").children().attr("src",a+"/add_icon._2_dis.gif")}else{$("#pop_cart_prom").find(".doPlus").children().attr("src",a+"/add_icon._2.gif")}};return{getBannerTemp:Ag,getBannerPopTemp:Aa,getCartTemp:Ad,getCartPriceTemp:Aj,getProductTemp:Ak,getPropDatil:T,getPropMain:H,getPopMain:R,getProdDetail:P,getBannerCorner:w,getWordLink:Ah,getSingleProductTemp:Al,getCartPromotion:J}}();var KFC_dialog=function(){var B=function(D,E){$(E).dialog({resizable:false,height:"auto",width:582,draggable:false,fixed:false,dialogClass:D,position:{my:"center",at:"center",of:window,collision:"fit"},modal:true});$(E).removeClass("ui-dialog-content")};var A=function(D){$(D).dialog("close")};var C=function(D){var E=false;if(D){E=true;$.cookie(yumCfg.myNotNeed,E,{expires:yumCfg.keep})}else{$.cookie(yumCfg.myNotNeed,E)}};return{close_dialog:A,show_dialog:B,myNotNeed:C}}();var KFC_PopUp_Show=function(){var B=function(I,G){var C=$(".popup_main");var D="#popupCon";C.empty();var E="";var F="";if(G){E=KFC_HTML.getProdDetail(I)}if(KFC_Comon.vaildPromNum(I,G)){F=KFC_Promotions.addHtml(I,G)}if(E==""&&F==""){return}C.attr("class","popup_main").addClass(function(){if(E==""){return"popbox_p_bg01"}return !F?"popbox_p_bg03":"popbox_p_bg02"});C.append(KFC_HTML.getPopMain(E,F,I,D));var H="middle_bg";KFC_dialog.show_dialog(H,D)};var A=function(M,S){var U=KFC_Promotions.getPromItemsById(M);var L=KFC_Products.getProductById(M);if(U==null){if(L.menuFlag=="P"){var Q={productId:L.systemId,quantity:L.num,itype:L.menuType};KFC_Comon.initCart("/executeOrder.action",Q);return}else{var Q={productId:L.systemId,quantity:L.num,classId:L.classExtId,objectId:L.p_index,itype:L.menuType};KFC_Comon.initCart("/executeMealItems.action",Q);return}}var N="";var G='{"count":{0},"promotionId":{1},"name":"{2}","classId":"{3}","promotionItemId":"{4}","isMeal":{5}}';var P='{"productId":"{0}","count":"{1}", "mFlag":"{2}","index":"{3}","itype":"{4}","items":[{5}]}';if(typeof U=="object"){for(var E in U){var C=U[E].currentQuantity;if(C!=0){var D=U[E].nameCN;var J=U[E].id;var H=U[E].pmid;var T=U[E].classId;if(N){N+=","}N+=G.format([C,J,D,T,H,0])}}}var I="";var F="";var O="";var K=0;var R="";if(S){I=L.num;F=L.systemId;O=L.menuFlag;K=L.p_index;if(L.menuType){R=L.menuType}}P=P.format([F,I,O,K,R,N]);KFC_Comon.initCart("/executePromo.action",{jsonStr:P})};return{OrderSubmit:A,pop_show:B}}();var KFC_Carnival={specialClassTemp:function(D){var B=KFC_GlobalVar.getGlobalVarByParam("httpVersionPath");var A='<li class="title1"><div class="showPicPop showPP_IE7"><img src="{0}" name="menuImg" style="width: 558px; height: 179px;"></div></li>';var C=D.imageUrl;if(!C){C=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var E=$(A.format([B+C]));return E},specialClassForOneTemp:function(G,B){var C=KFC_GlobalVar.getGlobalVarByParam("httpVersionPath");var A=$.localStr({cn:G.imageCnUrl,en:G.imageEnUrl},1);if(!A){A=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var D=$(KFC_Carnival.htmlTmp.oneHtml.classTemp.format([C+A]));var F=G.menuVoList;var E=KFC_Carnival.commonFn.getMenu(F,B);return D.append(E)},specialClassForTowOrThreeTemp:function(C,H,E){var B=KFC_GlobalVar.getGlobalVarByParam("httpVersionPath");var K=KFC_GlobalVar.getGlobalVarByParam("base");var F=$.localStr({cn:C.imageCnUrl,en:C.imageEnUrl},1);if(!F){F=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var M=K+"/res/images/carnival/tip.png";var I=property.everyDayNoon;var A=property.everyDayarvo;var G="off";var L=$(KFC_Carnival.htmlTmp.towOrThreeHtml.classTemp.format([B+F,M,I,A]));var J=KFC_Carnival.commonFn.getMenu(C.menuVoList,E,G);L.find(".noon").append(J);var D=KFC_Carnival.commonFn.getMenu(H.menuVoList,E,G);L.find(".arvo").append(D);return L},specialClassForFourTemp:function(F,B){var C=KFC_GlobalVar.getGlobalVarByParam("httpVersionPath");var A=$.localStr({cn:F.imageCnUrl,en:F.imageEnUrl},1);if(!A){A=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var E=F.menuVoList[0].imageUrl;if(!E){E=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}var D=$(KFC_Carnival.htmlTmp.fourHtml.classTemp.format([C+A,C+E]));return D},htmlTmp:{ul:"<ul></ul>",oneHtml:{classTemp:'<li class="title2"><div class="showPicPop showPP_IE7"><img src="{0}" name="menuImg" style="width: 118px; height: 193px;"></div> </li>',menuTemp:'<li><div class="showPicPop"><img src="{0}" name="menuImg"></div><div class="pro_info"><p class="center h34"><a href="javascript:;" class="pro_name">{1}</a></p><p class="center" style="margin-right: 0px;"> <span class="pro_price">{2} </span></p><p style="clear: both;" class="center"><img src="{3}" class="order_btn_start"></p></div></li>'},towOrThreeHtml:{classTemp:'<li class="title3"><div class="showPicPop showPP_IE7" objectid="0"><img src="{0}" name="menuImg" style="width: 118px; height: 193px;"></div><div class="noon"><div class="tip"><img src="{1}" style="width: 146px"></img><div>{2}</div></div></div><div class="arvo"><div class="tip"><img src="{1}" style="width: 146px"></img><div>{3}</div></div></div></li>'},fourHtml:{classTemp:'<li class="title4"><div class="showPicPop showPP_IE7" objectid="0"><img src="{0}" name="menuImg" style="width: 118px;height: 152px;"></div><div class="wxPic"><img src="{1}" name="menuImg"></div></li>'}},commonFn:{getMenu:function(B,G,E){var A=$(KFC_Carnival.htmlTmp.ul);var F=KFC_GlobalVar.getGlobalVarByParam("base");var C=KFC_GlobalVar.getGlobalVarByParam("httpVersionPath");var D=0;$.each(B,function(L,J){if(J.cornerMark){KFC_Ncornermarks.add(J.cornerMark,J.systemId)}if(G[J.systemId]){J.lightFlag="1"}var H="chickenNice/"+J.imageUrl;if(!H){H=$.localStr({cn:"no_pic.jpg",en:"no_pic_en.jpg"},1)}H=C+H;var K=$.localStr({cn:J.nameCn,en:J.nameEn},1);var N=$.moneyFormat(computationPrice(J.price))+pageMessage.home_Per;var I="";if(J.willSaleFlag==="1"){I=F+"/res/images/timeArrived_btn.png";if($.isEnglish()){I=F+"/res/images/en/timeArrived_btn.png"}}else{if("1"==J.disabledFlag||J.lightFlag==="0"){I=F+"/res/images/order_btn_1.png";if($.isEnglish()){I=F+"/res/images/en/order_btn_1.gif"}}else{I=F+"/res/images/order_btn.gif";if($.isEnglish()){I=F+"/res/images/en/order_btn.gif"}}}var M=$(KFC_Carnival.htmlTmp.oneHtml.menuTemp.format([H,K,N,I]));if("off"===E){M.find(".pro_price").parent().remove()}M.find(".showPicPop>img").click(function(){KFC_Carnival.commonFn.imgClick(J)});M.find(".order_btn_start").click(function(){KFC_Carnival.commonFn.orderBtn(J)});A.append(M);KFC_Products.add(J,D,M);KFC_HPT.addHalfPirce(J.menuType,J.systemId,M,J.lunch);D++});return A},orderBtn:function(C){var J=C.menuFlag;var H=C.linkType;var F=C.virtualLinkClass;var L=C.systemId;var E=C.disabledFlag;var B=C.willSaleFlag;var N=KFC_GlobalVar.getGlobalVarByParam("halfPriceNumber");if(J=="V"){if(H==1){if(window._tag){_tag.dcsMultiTrack("wt.event","menu","wt.msg",C.name)}KFC_Comon.initContent(F)}return}var I=KFC_Cart.getItemNmuById(L);var G=KFC_Products.getProductById(L);var M=G.num;var O=G.lightFlag;var D=G.isOrderFlag;var A=G.menuType;var K=G.maxQty;if("1"==E||"1"==B){return}if(A=="0"){K=N-KFC_Cart.getHptNum()}if(O=="0"){return}if(D=="0"){return}if(A=="0"){if(M>K||M==0){KFC_Products.modifyProductNumById(L,1);base.yumAlert(property.errorOrderItemsNum.format([N]));return}}else{if(I+M>K||M==0){KFC_Products.modifyProductNumById(L,1);base.yumAlert(property.errorOrderItemsNum.format([K]));return}}KFC_Cart.addProToCartById(L);if(window._tag){_tag.dcsMultiTrack("wt.event","orderAdd","wt.msg","txt","wt.pn_sku",L)}if(KFC_Status.getStatus().code&&KFC_Status.getStatus().code!=serviceCode.SUC_CODE){return}if($.cookie(yumCfg.myNotNeed)=="true"){return}if(KFC_Promotions.getPromItemsById(L)){base.yumCloseLoading();KFC_PopUp_Show.pop_show(L)}},imgClick:function(C){var A=C.virtualLinkClass;var B=C.systemId;if(C.menuFlag=="V"){if(index==0&&C.linkShowType==1){if(C.virtualLink.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(C.virtualLink)}}else{if(C.linkType==1){if(window._tag){_tag.dcsMultiTrack("wt.event","menu","wt.msg",C.name)}KFC_Comon.initContent(A)}else{if(C.linkType==2){if(C.virtualLink.indexOf("appIndex")>=0){base.setAction("appIndex.action")}else{window.open(C.virtualLink)}}}}}else{KFC_PopUp_Show.pop_show(B,true)}}}};var home={init:function(){KFC_Menu.init();KFC_Cart.submitCart();KFC_Comon.initCookie();KFC_Comon.initHotLink();KFC_Comon.initWordLink();KFC_Comon.initCart("/getOrderJson.action","");KFC_Cart.addBeforeLoginProduce();KFC_Comon.bindChangeAddressEvent()}};